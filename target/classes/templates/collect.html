<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>采集信息管理</title>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/spop.min.css"/>
    <link rel="stylesheet" href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css"/>
    <script src="js/spop.min.js"></script>
    <script src="js/common.js"></script>
    <script src="js/collect.js"></script>
    <link rel="stylesheet" href="css/syalert.min.css"/>
    <script src="js/syalert.min.js"></script>
    <link rel="stylesheet" href="css/collect.css">
    <link rel="stylesheet" type="text/css" href="css/jquery.dropdown.css">
    <script src="js/jquery.dropdown.js"></script>
</head>
<body>
<div id="top">
    <img style="width: 43px;margin-left: 110px;" src="/images/mju.png"/><span
        style="font-weight: bold">计算机与控制工程学院</span>
    <h6>你好！<span th:text="${session.user.username}">xxx</span><a href="/logout" id="exit">&nbsp&nbsp退出</a></h6>
    <input onclick="window.location.href='/collect'" class="btn btn-primary" type="button" id="picture" value="采集信息管理"/>
    <input onclick="window.location.href='/rabbish_category_list'" class="btn btn-primary" type="button" value="分类管理"/>
</div>
<script>
</script>
<div id="content">
    <br/>
    <h1 class="label label-info">采集信息管理</h1>
    <div class="row">
        <div class="col-sm-4">
            <div class="dropdown-sin-1">
                <select style="display:none" id="search" placeholder="Search for...">
                    <option disabled selected value></option>
                    <option th:each="item,index:${collectList}" th:value="${item.id}" th:text="${item.name}"></option>
                </select>
            </div>
        </div>
    </div>
    <script>
        $('.dropdown-sin-1').dropdown({
            readOnly: true,
            input: '<input type="text" maxLength="20" placeholder="请输入搜索">',
            choice: function (event) {
                var searchName = $(event.target).html()
                // alert(11)
                // $("#search option:checked").html()
                // alert(searchName)
                // $('#table_refresh').load("/collect?searchName="+searchName);
                $.ajax({
                    url: "http://localhost:8080/search",
                    data: {"searchName": searchName},
                    success: function (result) {
                        // alert(result)
                        $("#flash").html("")
                        $("#flash").html(result)
                        $('#search option').each(function () {
                            if (searchName == $(this).val()) {
                                $(this).prop("checked", true);
                            } else {
                                $(this).prop("checked", false);
                            }
                        });
                    }
                })
            }
        });
    </script>
    <br/>
    <div th:fragment="search" id="flash">
        <table id="collectTable" class="table table-bordered">
            <thead>
            <tr>
                <!--        <th><input id="selectAll" type="checkbox"/>全选</th>-->
                <th>ID</th>
                <th>采集名称</th>
                <th>采集说明</th>
                <th>创建时间</th>
                <th>总计</th>
                <th>编辑</th>
                <th>删除</th>
                <th>转入</th>
                <th>导出</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="item:${pageInfo.list}">
                <!--        <th><input type="checkbox" id="chooseInfo" name="imgId" th:value="${item.id}"/></th>-->
                <th th:text="${item.id}">1</th>
                <td>
                    <a id="collectName" th:text="${item.name}" th:href="'checkImagePage?id='+${item.id}"><span
                            class="glyphicon glyphicon-edit"></span>
                    </a>
                </td>
                <td th:text="${item.desc}"></td>
                <td th:text="${#dates.format(item.createTime, 'yyyy-MM-dd')}">yyyy-mm-ss</td>
                <td th:text="${item.count}"></td>
                <!--        <td><a class="operation" style="color: rgb(153,153,153)" th:href="'/approval?imgId='+${item.id}">审批</a>-->
                <!--            <a class="operation" style="color: rgb(153,153,153)" href="javascript:;" th:onclick="'delImage('+${item.id}+')'" >删除</a>-->
                <!--        </td>-->
                <td><a th:href="'collect_editPage?id='+${item.id}"><span
                        class="glyphicon glyphicon-edit"></span></a></td>
                <td><a href="javascript:void(0);" th:onClick="'delCollect('+${item.id}+')'"><span
                        class="glyphicon glyphicon-trash"></span></a>
                    <span style="color: red" th:if="${id==item.id}" th:text="${delerrMsg}"></span>
                </td>
                <td>
                    <a href="javascript:void (0);" th:onclick="'showModel('+${item.id}+')'">
                        <span class="glyphicon glyphicon-retweet"></span>
                    </a>
                </td>
                <td>
                    <a href="javascript:void (0);" th:onclick="'zipFile('+${item.id}+',\'collect\')'">
                        <span class="glyphicon glyphicon-log-out"></span>
                    </a>
                </td>

            </tr>
            </tbody>

        </table>

        <nav aria-label="Page navigation">
            <div id="foot">
                <span>显示</span>
                <select id="se" name="DataTables_Table_2_length" aria-controls="DataTables_Table_2"
                        class="form-control input-sm">
                    <option th:attr="selected=${pageInfo.pageSize==5}?'true':'false'" value="5">5</option>
                    <option th:attr="selected=${pageInfo.pageSize==7}?'true':'false'" value="7">7</option>
                    <option th:attr="selected=${pageInfo.pageSize==10}?'true':'false'" value="10">10</option>
                    <!--            <option value="10">10</option>-->
                </select>
                <span>项</span>
            </div>
            <ul class="pagination">
                <li th:class="${pageInfo.hasPreviousPage}?'':'disabled'">
                    <a th:if="${pageInfo.hasPreviousPage}"
                       th:href="'/collect?pageNum=1'+'&pageSize='+${pageInfo.pageSize}">首页</a>
                    <span th:if="${!pageInfo.hasPreviousPage}">首页</span>
                </li>
                <li th:class="${pageInfo.hasPreviousPage}?'':'disabled'">
                    <a th:if="${pageInfo.hasPreviousPage}"
                       th:href="'/collect?pageNum='+${pageInfo.prePage}+'&pageSize='+${pageInfo.pageSize}"
                       aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                    <span th:if="${!pageInfo.hasPreviousPage}">&laquo;</span>
                </li>
                <li th:class="${pageInfo.pageNum==nav}?'active':''" th:each="nav:${pageInfo.navigatepageNums}">
                    <a th:if="${pageInfo.pageNum!=nav}"
                       th:href="'/collect?pageNum='+${nav}+'&pageSize='+${pageInfo.pageSize}" th:text="${nav}">1</a>
                    <span th:if="${pageInfo.pageNum==nav}" th:text="${nav}"></span>
                </li>
                <li th:class="${pageInfo.hasNextPage}?'':'disabled'">
                    <a th:if="${pageInfo.hasNextPage}"
                       th:href="'/collect?pageNum='+${pageInfo.nextPage}+'&pageSize='+${pageInfo.pageSize}"
                       aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                    <span th:if="${!pageInfo.hasNextPage}" aria-hidden="true">&raquo;</span>
                </li>
                <li th:class="${pageInfo.hasNextPage}?'':'disabled'">
                    <a th:if="${pageInfo.hasNextPage}"
                       th:href="'/collect?pageNum='+${pageInfo.pages}+'&pageSize='+${pageInfo.pageSize}">尾页</a>
                    <span th:if="${!pageInfo.hasNextPage}" aria-hidden="true">尾页</span>
                </li>
            </ul>
        </nav>
        <div class="panel panel-warning editDiv" style="width: 400px;margin: 0px auto;">
            <div class="panel-heading">新增采集</div>
            <div class="panel-body">
                <table class="editTable">
                    <tbody>
                    <form th:action="@{/collect_add}">
                        <input type="hidden" th:name="pageSzie" th:value="${pageInfo.pageSize}"/>
                        <input type="hidden" th:name="pageNum" th:value="${pageInfo.pageNum}"/>
                        <tr>
                            <td>采集名称</td>
                            <td><input id="name" name="name" th:value="${name}" type="text" class="form-control"></td>
                        </tr>
                        <tr>
                            <td>采集说明</td>
                            <td><textarea style="resize:none;" th:text="${desc}" id="desc" name="desc" class="form-control"></textarea>
                            </td>
                        </tr>
                        <tr class="submitTR">
                            <td align="center" colspan="2">
                                <input type="button" onclick="addCollect()" class="btn btn-success" th:value="提交">
                                <span style="color: red" hidden th:text="${errMsg}"></span>
                            </td>
                        </tr>
                    </form>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Modal 转入 -->
        <div class="modal fade" id="exampleModalScrollable" tabindex="-1" role="dialog"
             aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title" id="exampleModalScrollableTitle">==>其他采集</h3>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div th:each="item,index:${collectList}">
                            <input th:id="${item.id}" type="radio" name="collectId" th:value="${item.id}"/>
                            <label th:for="${item.id}" th:text="${item.name}"></label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="changeTo()">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 确认弹窗 -->
    <div class="sy-alert animated" sy-enter="zoomIn" sy-leave="zoomOut" sy-type="confirm" sy-mask="true" id="alert1">
        <div class="sy-title">温馨提示</div>
        <div class="sy-content">确认要删除吗？</div>
        <div class="sy-btn">
            <button onClick="syalert.syhide('alert1')">取消</button>
            <button onClick="ok('alert1')">确定</button>
        </div>
    </div>
</body>
</html>